---
title: "anc_analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r cache=TRUE, echo=FALSE}

library(tidyverse)

# load data
path <- getwd()  # lacks trailing slash

#print(path)

election.data <- read.csv(file=paste(path, "/cleaned_data/election_history_R.csv", sep=""), 
                          header=TRUE, sep=",")

head(election.data)

# check counts; expect 296 obs per year
check <- election.data %>% group_by(year) %>% tally()
#print(check)
check2 <- election.data %>% group_by(year, ward) %>% tally()
#print(check2)


# ideas-----
# vote proportions across space
# candidates across space
# esp. uncontested and no candidates
# did a write-in ever beat a candidate??
# dist. of winning vote #s

election.data$write_in_winner <- grepl("write", tolower(election.data$winner))
election.data <- election.data %>% mutate(uncontested = explicit_candidates == 1, 
                        empty = explicit_candidates == 0, w_over_cand = write_in_winner & !empty)

sum <- election.data %>% group_by(ward, year) %>% summarize(cand = mean(explicit_candidates), 
                            votes = mean(winner_votes), vote_norm = mean(winner_votes / smd_ballots),
                            engagement = mean(smd_anc_votes / smd_ballots))
sum %>% print(n=nrow(.))


```



Yenlo Atmro


```{r}

require(tidyverse)

s <- as.data.frame(sum)
y <- ggplot(s, aes(ward, engagement)) + geom_point(aes(colour=factor(year)))
y

```